# 目次

- 今回の勉強会の目的
- UNIXの基礎
    - UNIXとは？
    - GUI / CLI
    - シェルとOSカーネル
    - ファイルシステム
    - ファイルパーミッション
- UNIXコマンド基礎
    - ディレクトリ系
    - ファイル操作系
    - 検索系
    - 正規表現入門
    - 更なる成長のために...
- 最後に
    - ひとこと
    - 次回以降にやれたら良いなと思ってること

---

# 今回の勉強会の目的

---

## 現状の問題点

**インターン生の成果が芳しくない**

- 実力不足？
- 時間不足？
- マネジメント不足？

---
## 今回のfocus

- 実力不足？
- **時間不足！**
- マネジメント不足？

効率的に時間を使って成果を出そう！
-> 個々のプログラミング言語以前の問題でつまづくことを無くしていきたい

---
## 今回のアプローチ

まとめて身につけるべき知識が抜けている
-> UNIXの基礎を学ぼう！
限られた時間を効率的に使うために必要な知識をつけたい
-> **CLI** (後述) **を使いこなそう！**
-> といったものの学ぶべきものがとても多いので、今回は**基礎of基礎**を身につけてもらいます

---
## 今回の目標

1. パソコンがどうやって動いているのか簡単に説明できるようになる。パソコンの気持ちになる。OSとは？パソコンはどうやって命令を実行してる？
1. GUIでやっていることをCLIでもできるようになる。具体的には、Finderより先にTerminalを開きたいと思える人間になる。

---
## 始める前の準備

以下のコマンドを打ってください。内容については考えないでください。
`$ cd`
`$ git clone https://github.com/tacchan7412/scoville_unix_study.git`
`$ chmod u+x set_up.sh`
このリポジトリは練習問題用です。

---
# UNIXの基礎

---
## UNIXとは？

- OSの一種
- Mac OS X は UNIX OS を元に作られている

---
### OSとは？

- Operating System の略称
- コンピュータの操作をするための中心的なプログラムの集合体
    - ハードウェアとのやりとり
    - ユーザー、アプリケーションプログラムとのやりとり
- OSの中で特に中核的な機能の部分を**OSカーネル**という

今回はOS(UNIX OS)の提供する機能を最大限使いこなせるようになりましょう

---
## GUI / CLI

- GUI
    - Graphical User Interface
    - マウスなどで画面上のメニューやアイコンをクリックして操作を行う
- CLI
    - Command Line Interface
    - コマンドなどを文字列として入力することで操作を行う

---
### なぜCLIを使いこなせるようになりたいのか

- **作業効率が上がる**
    - マウスやトラックパットに手を置く必要がなくなる
- サーバーではCLIの操作が基本
- より本質的である
- プログラムの連携がしやすい
- 処理の自動化がしやすい
- (かっこいい)

---
## シェルとOSカーネル
そもそもコマンドが指定する操作をどうやってOSはしているのか？
例: `$ echo Hello`

1. `echo Hello` を文字列として受け取る
2. コマンド部分である`echo`という名前のコマンドを探す
3. コマンドが見つかったらそれを**(OSカーネルが)実行する**
4. 実行結果の文字列(この場合は`Hello`)を画面に表示する

1~4の太字以外の部分を**「シェル」**が担っている
つまりシェルとは**OSカーネルのインターフェースとなっているソフトウェア**である

---
### (余談)$PATHについて

シェルの設定ファイルに`PATH`という環境変数を書くと指定された場所(ディレクトリ)からシェルがコマンドを見つけることができるようになる。(シェルのコマンドの検索対象になる)

`$ echo $PATH`で確認できる。ここでは場所(ディレクトリ)を`:`で連結して表示している。確認してみましょう。

これによりコマンド名だけでコマンドが実行できるようになる。
実際の実行ファイルを確認するには`which (コマンド名)`で調べれば良い

---
### シェルの種類

- sh
- csh
- **bash**
- tcsh
- **zsh**

`$ echo $SHELL`で自分の使っているシェルを確認してみましょう

---
### シェルの便利機能

- コマンドラインの編集(抜粋)

| 操作 | 入力キー |
|:-:|:-:|
|カーソルの後退|Ctrl + b|
|カーソルの前進|Ctrl + f|
|行頭への移動|Ctrl + a|
|行末への移動|Ctrl + e|
|カーソル位置で削除|Ctrl + d|
|カーソル位置から行頭まで削除|Ctrl + k|
|カーソル位置から行末まで削除|Ctrl + u|

適当に文字を打って移動したり削除したりしてみましょう

- 補完機能
Tabで補完される

- コマンド履歴

| 操作 | 入力キー |
|:-:|:-:|
|一つ前のコマンド|Ctrl + p or ↑|
|次のコマンド|Ctrl + n or ↓|
|履歴検索|Ctrl + r|

---
## ファイルシステム

UNIXで扱う情報(データ)は**ファイル**として表現される
ファイルを整理する入れ物である**ディレクトリ**が用意されている
「/」という**ルートディレクトリ**を頂点とした階層構造になっている
ファイルやディレクトリを指定するのに**パス**を使う

---
### ディレクトリとは

ディレクトリはファイルを整理する入れ物と考えるとわかりやすい
ディレクトリの中にディレクトリを入れることもできる(サブディレクトリ)

ルートディレクトリ: 階層構造の頂点
ホームディレクトリ: (Mac OSの場合) `/Users/(ユーザー名)`。それぞれのユーザーに割り振られる。シェルに最初に入った時はここにいる(はず)。`$ cd`もしくは`$ cd ~`で移動できる。
カレントディレクトリ: 自分が現在位置しているディレクトリ。`$ pwd`で確認できる。

ディレクトリは
- `.`: カレントディレクトリ
- `..`: 親ディレクトリ

を持っている。(`ls -a`)で確認できる。

---
### パスとは

ファイルやディレクトリを指定する
ディレクトリ間の区切りは「/」を使う

例: `/Users/tatsukikoga/python/moshimoshi/main.py`
「ルートディレクトリの下のUsersディレクトリの下のtatsukikogaディレクトリの下のpythonディレクトリの下のmoshimoshiディレクトリの下のmain.pyというファイル」というのを簡単に指定できる

---
### 相対パス、絶対パス

相対パス: **カレントディレクトリ**を起点として表記されるパス
絶対パス: **ルートディレクトリ**を起点として表記されるパス

---
### 展開

シェルが特定の文字列をパスへと置換してくれる

チルダ展開
`~`でホームディレクトリに置換される。
`~/Desktop` -> `/Users/(ユーザー名)/Desktop`

ワイルドカード展開
`*`で任意の文字列に、`?`で任意の1文字と解釈される。
`ls ba*`
baで始まるファイル一覧が表示される
`ls *.py`
拡張子が.pyのファイル一覧が表示される
`ls ba??`
baで始まり全体で4文字のファイルが表示される

---
## ファイルパーミッション

ユーザーとファイルの関係は以下の3つがある
- ファイルの所有者(u)
    - ファイルには全て所有者が設定されている。所有者はファイルへのアクセス権限を自由に設定できる。
- グループに所属するユーザー(g)
    - グループとはユーザーをまとめたもの
- その他のユーザー(o)

上の3つに対して誰がどこまでファイルを触ることができるか(アクセス権限)が設定されている。ディレクトリに対してもファイルと同様のアクセス権限が設定できるが意味合いが少し異なる。

- 読み取り(**r** ead)
    - ファイルを読むこと、見ること
- 書き込み(**w** rite)
    - ファイルに書き込みをすること、編集すること
- 実行(e **x** ecute)
    - ファイルを実行すること

`$chmod [u,g,o,a][+,-,=][rwx] (ファイル名)`
でファイルの権限を変えることができる
例: `chmod u+rx hoge.txt`
hoge.txtの所有者に対して読み込み権限と実行権限を与える
* aはugo全て
* +で権限付与、-で権限禁止、=で指定した権限と等しくする
* rwxの代わりに2進数を使った権限指定の方法もある

---
### (余談)隠しファイルとは

`.`で始まるファイルやディレクトリのこと
隠しファイルにすると通常の`ls`などでは出力されない。`ls -a`とすると隠しファイルも含めて出力される。
ファイル等を基本的に非表示にすることで普段触れる必要のないファイルやディレクトリを誤って削除や変更してしまうリスクが下がる。

---
## 練習問題1

`ls`コマンドと展開を使って`ex1`ディレクトリの隠しファイル**のみ**表示してください。
答え合わせをするには、
`$ (コマンド) | ./ans.sh`
と実行してみてください。

---
# UNIXコマンド基礎

`$ コマンド オプション... コマンドライン引数...`
という形になっている。基本的に全てスペースで区切る。

コマンド: `cd`, `pwd`, `ls`, `grep`, etc...
オプション: `-`や`--`で始まる。`-a`など。コマンドによって異なる。オプションが引数をとる場合もある
コマンドライン引数: コマンドに与える引数。

---
## ディレクトリ系

`pwd`: カレントディレクトリを表示する
`cd`: 引数で指定されたディレクトリへ移動する
`ls`: 引数で指定されたファイルやディレクトリを表示する

---
## ファイル操作系

`mkdir`: ディレクトリを作成する。`-p`で多階層のディレクトリを一気に作成できる
例: `$ mkdir work`
`$ mkdir -p work/scoville/2018`

`touch`: 引数で指定した名前のファイルを作成する。(本来はファイルのタイムスタンプを更新するためのコマンド)
例: `$ touch hoge.txt`

`rm`: 指定されたファイルを削除する。`-r`でディレクトリも削除できる。
`rmdir`: 空のディレクトリを削除できる。
例: `$ rm hoge.txt`
`$ rm -r hogehoge`

`cat`: ファイルの内容を表示する
`less`: ファイルの先頭から画面に収まるまでの量のファイルの内容を表示する。スクロール可能。
例: `$ cat hoge.txt`
`$ less hoge.txt`

`cp`: ファイルをコピーする
例: `$ cp file1 file2`
file1をfile2という名前でコピーする。
`$ cp file1 dir1`
file1を同じ名前でdir1というディレクトリにコピーする
`$ cp file1 file2 file3 dir1`
file1, file2, file3をdir1にコピーする
`$ cp -r dir2 dir3`
(dir3がない場合) dir2というディレクトリをdir3としてコピーする
(dir3がある場合) dir2をdir3の中にコピーする

`mv`: ファイルを移動する
例: `$ mv hoge.txt fuga.txt`
ファイルの名前を変更する
`$ mv hoge.txt dir1`
dir1にhoge.txtを移動する

---
## 練習問題2

`ls`の`-l`の意味を調べて実行してみて、練習問題1の答えが盗み見できない理由を考えてください。
盗み見するにはどうすればいいでしょうか？`ex2`の`ans.txt`を盗み見て(catで)答えを確認しましょう。

---
## 検索系

`find`: ファイルを探す
例: `$ find . -name '*.txt'`
カレントディレクトリ以下にあるファイル名の末尾が.txtのファイルを探す。この時ワイルドカード展開されないように`*.txt`をシングルクオート(もしくはダブルクオート)で囲わなくてはいけない。
`$ find . -type d`
カレントディレクトリ以下のディレクトリを列挙する。

`grep`: 指定した検索パターンに一致する行だけ表示する。**フィルタ**(次回？)の一種。
例: `$ grep bash /etc/passwd`
bashという文字列を含む行を/etc/passwdから表示する。
`grep -v bash /etc/passwd`
bashという文字列を**含まない**行を/etc/passwdから表示する。

---
## 練習問題3

`ex3`の中から`ans.sh`を(findを使って)探してください。
次に`ans.sh`が入っているディレクトリに`ex3`の直下にある`.txt`ファイルを(1コマンドで)全てコピーしてください。
最後に`$ ./ans.sh`を実行して`OK`と出力されることを確認してください。

---
## 正規表現入門

grepでは通常の文字列以外に**正規表現**という検索パターンを指定できる
正規表現とは条件に合致する文字列集合を表現するための記法
grepでは正規表現はクオートで囲んでおかないとワイルドカード展開されてしまうことがあるので注意！
また`-E`オプションをつけることで拡張正規表現を使える

---
### メタ文字

正規表現で特別な意味をもつ記号のこと

`.`: 任意の1文字
例: `s.n`ならsun, son, ...などが含まれる行にマッチする

`[ ]`: []の中に含まれるいずれか1文字
例: `s[uo]n`ならsun, sonが含まれる行にマッチする
`[a-zA-Z]`なら小文字大文字のアルファベットが含まれている行にマッチする

`[^ ]`: []の中に含まれないいずれかの1文字
例: `mail[^13]`ならmail1, mail3にはマッチしない

`^`: 行頭を意味する
例: `^net`なら行頭にnetという文字がある行にだけマッチする

`$`: 行末を意味する
例: `net$`なら行末がnetである行にだけマッチする

`*`: 0回以上の繰り返すを表す
例: `Be*r`ならBr, Ber, Beerなどにマッチする

`+`: 1回以上の繰り返しを表す(拡張)
例: `Be+r`ならBer, Beerなどにマッチする。Brにはマッチしない

`?`: 0回または1回の繰り返しを表す(拡張)
例: `Wine ?Wine`ならWine WineとWineWineどちらにもマッチする

`{}`: 繰り返し回数を指定する
例: `Be{1,2}r`ならBer, Beerにマッチする(1回以上2回以下の繰り返し)
`Be{2}r`ならBeerにマッチする(ちょうど2回繰り返し)
`Be{2,}r`ならBeer, Beeer, Beeeer, ...にマッチする(2回以上の繰り返し)

`()`: 正規表現のグループ化する
例: `(Wine){2,}`ならWineWine, WineWineWine, ...にマッチする(Wineをグループ化している)

`|`: 複数の正規表現をOR条件でつなげる
例: `My (Vodka|Wine)`ならMy WodkaとMy Wineにマッチする

`\`: 直後のメタ文字の意味を打ち消す(ただの文字列として扱うようにするということ)。エスケープするという。
例: `\.org`なら.orgという文字列にマッチするようになる

---
### 正規表現の利用

grep以外にもvimやlessで`/`の後ろにパターンを入力することで正規表現を使うことができる
Atomの検索でも...!

---
## 練習問題4

`ex4`の`article.md`から
- 数字の含まれている行を抽出してください。
- 見出し1(#)、見出し2(##)、見出し3(###)の行を抽出してください。
- 太文字の部分(**で囲われている)を含む行を抽出してください。

答え合わせは実演します。

---
## 更なる成長のために...

とにかくコマンドを使うようにして慣れましょう

- コマンドの使い方が思い出せない
    - `man (コマンド名)`を使う <- 英語だけど実際わかりやすい
    - ネットで調べる <- 使い方の具体例とかが載っているかも
- 新しいコマンドをどうやって身につければいいかわからない
    - `man -k (探したい機能)`を使ってみる
    - 本を一通り読んでみる
    - 人がどんなコマンドを使ってるか観察する

---
# 最後に

---
## ひとこと

今回はUNIX OSの基礎から正規表現までをさらっていきました。
覚えることが多く感じたかもしれませんが、今日発表したような内容はエンジニアとしての基礎体力だと思っています。
是非身につけましょう！！

---
## 次回以降にやれたら良いなと思ってること

- シェルスクリプト
- テキスト処理
- 標準入出力とは
    - パイプ
    - リダイレクト
    - フィルタ
- ファイルパーミッション
- プロセスとジョブ
- アーカイブと圧縮
- Git
- リモートログイン、SSH
